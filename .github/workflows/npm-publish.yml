name: Node.js CI update

on:
  push:
    branches: ['hamza']
    paths: ['backend/**']

jobs:
  build:
    runs-on: self-hosted
    defaults:
      run:
        working-directory: 'backend' # Here the path to the folder where package-lock.json is located.


      
    steps:
      - name: Set working directory to backend
        working-directory: backend
      - uses: actions/checkout@v3
        with:
          path: 'backend'  # Specify the backend folder path here
         
      - name: Generate dependencies lock file
        run: npm install --package-lock-only
        working-directory: backend  # Set the working directory to the backend folder

      - name: Use Node.js ${{ matrix.node-version }}
        working-directory: backend
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm'
          working-directory: 'backend'  # Set the working directory to the backend folder
    
      - run: npm ci
      - run: |
          touch .env
          echo "${{ secrets.PROD_ENV_FILE }}" > .env
